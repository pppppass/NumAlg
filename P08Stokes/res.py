def calc_res_close_u(size, u):
    n = size
    r_u = (
          u[:-1:2, ::2] / 8.0
        + u[1::2, ::2] / 4.0
        + u[2::2, ::2] / 8.0
        + u[:-1:2, 1::2] / 8.0
        + u[1::2, 1::2] / 4.0
        + u[2::2, 1::2] / 8.0
    )
    return r_u


def calc_res_close_v(size, v):
    r_v = (
          v[::2, :-1:2] / 8.0
        + v[::2, 1::2] / 4.0
        + v[::2, 2::2] / 8.0
        + v[1::2, :-1:2] / 8.0
        + v[1::2, 1::2] / 4.0
        + v[1::2, 2::2] / 8.0
    )
    return r_v


def calc_res_close_p(size, p):
    r_p = (
          p[::2, ::2] / 4.0
        + p[::2, 1::2] / 4.0
        + p[1::2, ::2] / 4.0
        + p[1::2, 1::2] / 4.0
    )
    return r_p
